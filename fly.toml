app = "multi-ai-chatbot"
primary_region = "ams"

[build]
  dockerfile = "docker/Dockerfile.cpu"

[env]
  PORT = "8080"

[processes]
  # Use ${PORT} so Fly injects the env var
  web = "uvicorn api.main_pdf:app --host 0.0.0.0 --port ${PORT} --log-level info"

[[services]]
  # Point this service at the "web" process above
  process       = "web"
  internal_port = 8080
  protocol      = "tcp"

  [[services.ports]]
    port     = 80
    handlers = ["http"]

  [[services.http_checks]]
    path         = "/health"
    interval     = "10s"
    timeout      = "3s"
    grace_period = "60s"   # give uvicorn imports time to load

  [[services.tcp_checks]]
    interval     = "10s"
    timeout      = "3s"
    grace_period = "60s"
